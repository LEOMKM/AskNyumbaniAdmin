(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1918:function(e,s,t){Promise.resolve().then(t.t.bind(t,7960,23)),Promise.resolve().then(t.bind(t,3606)),Promise.resolve().then(t.bind(t,3844)),Promise.resolve().then(t.bind(t,4849)),Promise.resolve().then(t.t.bind(t,4742,23))},3606:function(e,s,t){"use strict";t.d(s,{Toaster:function(){return o}});var r=t(7437),n=t(8298),i=t(4438);let o=e=>{let{...s}=e,{theme:t="system"}=(0,n.F)();return(0,r.jsx)(i.x7,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})}},3844:function(e,s,t){"use strict";t.d(s,{AuthProvider:function(){return a},a:function(){return u}});var r=t(7437),n=t(2265),i=t(970);let o=(0,n.createContext)(void 0);function a(e){let{children:s}=e,[t,a]=(0,n.useState)(null),[u,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=localStorage.getItem("admin_session_token");e?m(e):d(!1)},[]);let m=async e=>{try{let{data:s,error:t}=await i.O.rpc("validate_admin_session",{p_session_token:e});if(t||!s||0===s.length){localStorage.removeItem("admin_session_token"),l(null),a(null),d(!1);return}let r=s[0];a({id:r.admin_user_id,email:r.email,full_name:r.full_name,role:r.role,is_active:r.is_active,is_first_login:!1}),l(e)}catch(e){console.error("Session validation error:",e),localStorage.removeItem("admin_session_token"),l(null),a(null)}finally{d(!1)}},_=async(e,s)=>{try{d(!0);let{data:t,error:r}=await i.O.rpc("admin_login",{p_email:e,p_password:s});if(r)return{success:!1,message:r.message};if(!t||0===t.length)return{success:!1,message:"Invalid email or password"};let n=t[0],o=n.session_token;return localStorage.setItem("admin_session_token",o),l(o),a({id:n.admin_user_id,email:n.email,full_name:n.full_name,role:n.role,is_active:n.is_active,is_first_login:n.is_first_login}),{success:!0,message:"Login successful"}}catch(e){return console.error("Login error:",e),{success:!1,message:"An error occurred during login"}}finally{d(!1)}},g=async e=>{try{d(!0);let{data:s,error:t}=await i.O.rpc("admin_login_with_pin",{p_pin:e});if(t)return{success:!1,message:t.message};if(!s||0===s.length)return{success:!1,message:"Invalid PIN"};let r=s[0],n=r.session_token;return localStorage.setItem("admin_session_token",n),l(n),a({id:r.admin_user_id,email:r.email,full_name:r.full_name,role:r.role,is_active:r.is_active,is_first_login:!1}),{success:!0,message:"Login successful"}}catch(e){return console.error("PIN login error:",e),{success:!1,message:"An error occurred during PIN login"}}finally{d(!1)}},f=async e=>{try{if(!t)return{success:!1,message:"No user logged in"};let{error:s}=await i.O.rpc("create_admin_pin",{p_admin_user_id:t.id,p_pin:e});if(s)return{success:!1,message:s.message};return{success:!0,message:"PIN created successfully"}}catch(e){return console.error("Create PIN error:",e),{success:!1,message:"An error occurred creating PIN"}}},p=async()=>{try{u&&await i.O.rpc("invalidate_admin_session",{p_session_token:u})}catch(e){console.error("Logout error:",e)}finally{localStorage.removeItem("admin_session_token"),l(null),a(null)}},h=async()=>{u&&await m(u)};return(0,r.jsx)(o.Provider,{value:{user:t,sessionToken:u,isLoading:c,login:_,loginWithPin:g,createPin:f,logout:p,refreshSession:h},children:s})}function u(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4849:function(e,s,t){"use strict";t.d(s,{QueryProvider:function(){return a}});var r=t(7437),n=t(2979),i=t(9827),o=t(2265);function a(e){let{children:s}=e,[t]=(0,o.useState)(()=>new n.S({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1}}}));return(0,r.jsx)(i.aH,{client:t,children:s})}},970:function(e,s,t){"use strict";t.d(s,{O:function(){return r}});let r=(0,t(1545).eI)("https://yqilhwaexdehmrcdblgz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlxaWxod2FleGRlaG1yY2RibGd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwODk3MDAsImV4cCI6MjA3NTY2NTcwMH0.aZhWBpB1EfckSU82hEi_c5tKptjcCMChDETCPjAVESs")},7960:function(){}},function(e){e.O(0,[540,545,954,960,971,117,744],function(){return e(e.s=1918)}),_N_E=e.O()}]);